---
title: "COVID19 data exploration"
output: html_document
author: 
- Anass Al AMMIRI
- Ziyad OULHAJ
---

```{r setup, include=FALSE}
library("COVID19")
library("tidyverse")
library("skimr")
cov19=covid19()
```

# Introduction

Le package COVID 19 recense des données sur l'épidémie du coronavirus SARS-CoV-2 dans différents pays. Il ajoute à cela des indicateurs géographiques et des indicateurs exogènes pour faciliter l’étude de la pandémie dans sa globalité.



## Nombre de cas en fonction du nombre de personnes vaccinées complétement


```{r pressure, echo=FALSE}
cov19 %>% select(confirmed,people_fully_vaccinated,date) %>% 
  filter(!is.na(confirmed),!is.na(people_fully_vaccinated)) %>% 
  group_by(date )%>% 
  ggplot(aes(x=people_fully_vaccinated))+
  geom_smooth(aes(y=log(confirmed)),method = 'gam',formula=y~s(x,bs='cs'))
```

La vaccination a un effet de réduction du nombre de cas lorsque le nombre de personnes vaccinées dépasse une certaine jauge. C'est la notion d'immunité collective qui correspond au "pourcentage d’une population donnée qui est immunisée/protégée contre une infection à partir duquel un sujet infecté introduit dans cette population va transmettre le pathogène à moins d’une personne en moyenne, amenant de fait l’épidémie à l’extinction, car le pathogène rencontre trop de sujets protégés" (Institut Pasteur).

## Nombre de morts en fonction du nombre de cas
```{r, echo=FALSE}
cov19 %>% select(deaths,confirmed,date) %>% 
  filter(!is.na(deaths),!is.na(confirmed)) %>% 
  group_by(date )%>% 
  ggplot(aes(x=confirmed))+
  geom_smooth(aes(y=deaths),method='gam',formula=y~s(x,bs="cs"));
```

On remarque qu'il y a une tendance linéaire entre nombre de cas et nombres de morts. Cela correspond au taux de mortalité de la maladie. Essayons de la déterminer par régression linéaire :
```{r mortality rate}
cov19 %>% select(deaths,confirmed,date) %>% 
  filter(!is.na(deaths),!is.na(confirmed)) %>% 
  group_by(date )%>% 
  lm(formula=deaths~confirmed)
```
Le taux de mortalité selon nos données est de 1.762%.

## Classement des 10 pays ayant le plus grand nombre de cas
```{r}
cov19 %>% select(confirmed,iso_alpha_3) %>% 
  filter(!is.na(confirmed)) %>% 
  group_by(iso_alpha_3 )%>% 
  summarise(cases=max(confirmed)) %>% 
  arrange(desc(cases)) %>% 
  head(10) %>% 
  ggplot()+geom_col(aes(x=iso_alpha_3,y=cases))
```

Le nombre de cas est fortement lié au nombre d'habitant du pays, classons donc les pays par taux de personnes contaminée.
```{r}
cov19 %>% select(confirmed,iso_alpha_3) %>% 
  filter(!is.na(confirmed)) %>% 
  group_by(iso_alpha_3 )%>% 
  summarize(cases=max(confirmed)) %>% 
  left_join(world_bank_pop %>% filter(indicator=="SP.POP.TOTL") %>%select(country,"2017"),by=c("iso_alpha_3"="country")) %>% 
  rename(pop="2017") %>% 
  filter(!is.na(pop)) %>% 
  mutate(prop=cases/pop) %>% 
  arrange(desc(prop)) %>% 
  head(10) %>% 
  ggplot()+geom_col(aes(x=iso_alpha_3,y=prop))
```

## Évolution des cas et du confinement en fonction du temps en France

```{r}
cov19 %>% filter(iso_alpha_3=='FRA') %>% 
  select(confirmed,stay_home_restrictions,date) %>% 
  filter(!is.na(confirmed),!is.na(stay_home_restrictions),!stay_home_restrictions<0) %>% 
  ggplot(aes(x=date))+geom_line(aes(y=confirmed))+geom_area(aes(y=stay_home_restrictions*1.2e+07),fill="#9898fb",alpha=0.3)
```


On constate que les périodes de confinement sont celles qui ont connues une forte grimpe dans le nombre de cas. On peut le voir d'une manière plus positive : les périodes qu'on a identifié comme nécessitant un confinement se sont bien avérées être dangereuses.

